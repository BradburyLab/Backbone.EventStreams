/*! Backbone.EventStreams - v0.1.0 - 2014-04-15
* https://github.com/pyykkis/Backbone.EventStreams
* Copyright (c) 2014 Jarno Keskikangas <jarno.keskikangas@leonidasoy.fi>; Licensed MIT */
(function(){var e,t,n,r=[].slice;n=function(e,t){var n,i;return t.EventStream={listenToEventStream:function(t,n,i){var s;return i==null&&(i=_.identity),s=this,new e.EventStream(function(o){var u,a;return u=function(){var t,n;t=1<=arguments.length?r.call(arguments,0):[],n=o(new e.Next(i.apply(null,t)));if(n===e.noMore)return a()},a=function(){return s.stopListening(t,n,u)},s.listenTo(t,n,u),a})},asEventStream:function(t,n){var i;return n==null&&(n=_.identity),i=this,new e.EventStream(function(s){var o,u;return o=function(){var t,i;t=1<=arguments.length?r.call(arguments,0):[],i=s(new e.Next(n.apply(null,t)));if(i===e.noMore)return u()},u=function(){return i.off(t,o)},i.on(t,o,this),u})}},_.extend(t,t.EventStream),_.extend(t.Model.prototype,t.EventStream),_.extend(t.Collection.prototype,t.EventStream),_.extend(t.Router.prototype,t.EventStream),_.extend(t.History.prototype,t.EventStream),_.extend(t.View.prototype,t.EventStream),t.BaconProperty={toModel:function(){var e,n;return n=new t.Model(this.take(1)),e=function(e){return n.set(e)},this.onValue(e),n}},_.extend(e.Property.prototype,t.BaconProperty),function(e){return e.matches=e.matchesSelector=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||function(e){var t,n;n=(this.parentNode||this.document).querySelectorAll(e),t=-1;while(n[++t]&&n[t]!==this);return!!n[t]}}(Element.prototype),i=t.View.prototype.undelegateEvents,n={onEvent:function(t,n,r){var i,s;return(s=this.bus)==null&&(this.bus=new e.Bus),i=this.$el.asEventStream(t,n,r),this.bus.plug(i),this.bus.filter(function(e){return e instanceof $.Event&&e.type===t&&(n==null||e.currentTarget.matches(n))})},undelegateEvents:function(){var e,t;return e=1<=arguments.length?r.call(arguments,0):[],i.apply(this,e),(t=this.bus)!=null&&t.end(),this}},_.extend(t.View.prototype,n)},typeof module!="undefined"&&module!==null?(t=require("baconjs"),e=require("backbone"),module.exports=n(t,e)):typeof define=="function"&&define.amd?define(["bacon","backbone"],n):n(this.Bacon,this.Backbone)}).call(this);